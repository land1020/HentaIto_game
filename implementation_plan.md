# 結果発表画面スコア表示・順位判定ロジック修正計画

ユーザーの要望に基づき、結果発表画面における順位判定とスコア加算のロジックを修正します。また、累計スコアを非表示にします。

## User Review Required
- **順位判定基準の変更**:
    -   これまでは「累計スコア」で順位を決めていましたが、「**今回のラウンドスコア + 特別賞**」で順位を判定するように変更します。
- **順位ボーナスの適用順序**:
    -   上記で決定した順位に基づいて、順位ボーナス（1位+100点など）を加算します。
- **累計スコア非表示**:
    -   結果発表画面（`RankingList`）では累計スコアを表示しません。

## Proposed Changes

### Logic Update

#### [MODIFY] [App.tsx](file:///c:/Users/landk/OneDrive/Desktop/game/HentaIto/src/App.tsx)
-   `calculateTotalScore` 関数内の処理順序を変更します。
    1.  **基本点算出**: 履歴から累計スコアを計算し、今回のラウンド素点 (`scoreGain`) を特定。
    2.  **特別賞算出**: 従来通り計算し、`awards` に追加。ボーナス点を加算した「順位判定用スコア」 (`tempScore`) を算出。
    3.  **順位判定**: `tempScore` の降順でソートし、順位を確定。
    4.  **順位ボーナス加算**: 確定した順位に基づいて順位ボーナス (`rankBonuses`) を加算し、`awards` に追加。
    5.  **最終スコア確定**: 「順位判定用スコア」+「順位ボーナス」を今回のラウンドの最終獲得スコアとし、累計スコアに加算。

### UI Components

#### [MODIFY] [RankingList.tsx](file:///c:/Users/landk/OneDrive/Desktop/game/HentaIto/src/components/ui/RankingList.tsx)
-   **スコア表示**:
    -   `roundResults` がある場合（ラウンド結果表示時）、そのプレイヤーの「今回のラウンド最終獲得スコア」を表示するように変更。
        -   注: `roundResults` には素点 (`scoreGain`) しか含まれていないため、`players` オブジェクトが持つ今回の獲得スコア（もし保持していれば）を参照するか、`roundResults` と `awards` から計算する必要がある。
        -   `App.tsx` で計算された `players` の状態（`awards` などを含む）を利用するのが最も確実。
-   **ソート順序**:
    -   `roundResults` がある場合は、「今回のラウンド最終獲得スコア」の降順で表示する（すでに `App.tsx` でソートされていればそのまま表示、そうでなければソート）。
-   **累計非表示**:
    -   累計スコアの表示部分を削除。

## Verification Plan

### Manual Verification
1.  **ロジック確認**:
    -   ゲームを実行し、わざと接戦または点差が開く状況を作る。
    -   結果発表画面で、順位が「今回のラウンドスコア（素点+特別賞）」順になっているか確認する。
    -   順位ボーナスが、その順位に対して正しく付与されているか確認する（1位に+100, 2位に+50...）。
    -   「今回のラウンド結果」の合計点数が、「素点 + 特別賞 + 順位ボーナス」と一致しているか確認する。
2.  **表示確認**:
    -   累計スコアが表示されていないことを確認する。
